<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دورة Laravel - إطار عمل PHP المتقدم</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@200;300;400;500;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="script.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <button class="sidebar-mobile-toggle" id="sidebarMobileToggle">
                    <i class="fas fa-list"></i>
                </button>
                <div class="logo-section">
                    <img src="assets/Syrian_logo_icon_gold.png" alt="Ministry of Finance Logo" class="logo">
                </div>
                <div class="title-section">
                    <h1>دورة Laravel - إطار عمل PHP المتقدم</h1>
                    <p>تعلم تطوير تطبيقات الويب المتقدمة مع Laravel</p>
                </div>
            </div>
        </div>
    </header>

    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>
    
    <div class="page-layout">
        <main class="main-content">
            <div class="container">
            <!-- Introduction -->
            <section id="introduction" class="lesson-section active">
                <h2><i class="fas fa-rocket"></i> مقدمة في Laravel</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم ما هو Laravel ومميزاته</li>
                            <li>تعلم أساسيات إطار عمل PHP</li>
                            <li>فهم بنية مشروع Laravel</li>
                            <li>إعداد بيئة التطوير</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>ما هو Laravel؟</h3>
                        <p>Laravel هو إطار عمل PHP حديث وقوي مصمم لتطوير تطبيقات الويب بسرعة وسهولة. يتميز ببنية نظيفة وأدوات متقدمة تجعل التطوير أكثر كفاءة.</p>
                        
                        <div class="code-explanation">
                            <h4>مميزات Laravel الرئيسية:</h4>
                            <ul>
                                <li><strong>Eloquent ORM:</strong> نظام ORM متقدم للتعامل مع قاعدة البيانات</li>
                                <li><strong>Artisan CLI:</strong> أداة سطر الأوامر لإنشاء الكود</li>
                                <li><strong>Blade Templating:</strong> محرك قوالب قوي ومرن</li>
                                <li><strong>Routing:</strong> نظام توجيه متقدم ومرن</li>
                                <li><strong>Middleware:</strong> طبقة معالجة الطلبات</li>
                                <li><strong>Authentication:</strong> نظام مصادقة جاهز</li>
                                <li><strong>Testing:</strong> أدوات اختبار مدمجة</li>
                            </ul>
                        </div>

                        <h3>بنية مشروع Laravel</h3>
                        <pre><code>laravel-project/
├── app/                    # منطق التطبيق
│   ├── Http/
│   │   ├── Controllers/    # المتحكمات
│   │   ├── Middleware/     # الوسطاء
│   │   └── Requests/       # طلبات التحقق
│   ├── Models/             # النماذج
│   └── Providers/          # مقدمي الخدمات
├── config/                 # ملفات الإعدادات
├── database/
│   ├── migrations/         # هجرات قاعدة البيانات
│   └── seeders/           # بذور البيانات
├── public/                 # الملفات العامة
├── resources/
│   ├── views/             # قوالب Blade
│   └── js/                # ملفات JavaScript
├── routes/                # ملفات التوجيه
│   ├── web.php            # توجيهات الويب
│   └── api.php            # توجيهات API
└── storage/               # ملفات التخزين</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> شرح البنية:</h4>
                            <ul>
                                <li><strong>app/:</strong> يحتوي على منطق التطبيق الأساسي</li>
                                <li><strong>config/:</strong> ملفات إعدادات التطبيق</li>
                                <li><strong>database/:</strong> هجرات وبذور قاعدة البيانات</li>
                                <li><strong>public/:</strong> نقطة الدخول للتطبيق</li>
                                <li><strong>resources/:</strong> القوالب والملفات الثابتة</li>
                                <li><strong>routes/:</strong> تعريف مسارات التطبيق</li>
                                <li><strong>storage/:</strong> ملفات التخزين والسجلات</li>
                            </ul>
                        </div>

                        <h3>مبادئ Laravel الأساسية</h3>
                        <ul>
                            <li><strong>Convention over Configuration:</strong> الاتفاقيات بدلاً من الإعدادات المعقدة</li>
                            <li><strong>DRY (Don't Repeat Yourself):</strong> عدم تكرار الكود</li>
                            <li><strong>SOLID Principles:</strong> مبادئ البرمجة الكائنية</li>
                            <li><strong>Dependency Injection:</strong> حقن التبعيات</li>
                            <li><strong>Service Container:</strong> حاوية الخدمات</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Installation -->
            <section id="installation" class="lesson-section">
                <h2><i class="fas fa-download"></i> التثبيت والإعداد</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>تثبيت Composer و Laravel</li>
                            <li>إنشاء مشروع Laravel جديد</li>
                            <li>إعداد قاعدة البيانات</li>
                            <li>تشغيل خادم التطوير</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>متطلبات النظام</h3>
                        <ul>
                            <li>PHP 8.1 أو أحدث</li>
                            <li>Composer (مدير حزم PHP)</li>
                            <li>MySQL/PostgreSQL/SQLite</li>
                            <li>Node.js و NPM (لأدوات الواجهة الأمامية)</li>
                        </ul>

                        <h3>تثبيت Composer</h3>
                        <pre><code># تحميل Composer
curl -sS https://getcomposer.org/installer | php

# نقل Composer إلى مجلد النظام
sudo mv composer.phar /usr/local/bin/composer

# التحقق من التثبيت
composer --version</code></pre>

                        <h3>إنشاء مشروع Laravel جديد</h3>
                        <pre><code># إنشاء مشروع جديد
composer create-project laravel/laravel my-laravel-app

# الانتقال إلى مجلد المشروع
cd my-laravel-app

# تثبيت التبعيات
composer install

# نسخ ملف البيئة
cp .env.example .env

# توليد مفتاح التطبيق
php artisan key:generate</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> شرح الأوامر:</h4>
                            <ul>
                                <li><strong>create-project:</strong> ينشئ مشروع Laravel جديد</li>
                                <li><strong>composer install:</strong> يثبت جميع التبعيات</li>
                                <li><strong>cp .env.example .env:</strong> ينشئ ملف البيئة</li>
                                <li><strong>key:generate:</strong> يولد مفتاح تشفير للتطبيق</li>
                            </ul>
                        </div>

                        <h3>إعداد قاعدة البيانات</h3>
                        <pre><code># في ملف .env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=laravel_db
DB_USERNAME=root
DB_PASSWORD=

# أو لـ PostgreSQL
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=laravel_db
DB_USERNAME=postgres
DB_PASSWORD=password</code></pre>

                        <h3>تشغيل التطبيق</h3>
                        <pre><code># تشغيل خادم التطوير
php artisan serve

# التطبيق سيكون متاحاً على
# http://localhost:8000

# تشغيل في خلفية (اختياري)
php artisan serve --host=0.0.0.0 --port=8000</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-exclamation-triangle"></i> نصائح مهمة:</h4>
                            <ul>
                                <li>تأكد من تشغيل خادم قاعدة البيانات</li>
                                <li>تحقق من صلاحيات قاعدة البيانات</li>
                                <li>استخدم بيئة تطوير منفصلة عن الإنتاج</li>
                                <li>احتفظ بنسخة احتياطية من ملف .env</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Laravel Basics -->
            <section id="basics" class="lesson-section">
                <h2><i class="fas fa-code"></i> أساسيات Laravel</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم Artisan CLI وأوامره الأساسية</li>
                            <li>تعلم إنشاء Controllers و Views</li>
                            <li>فهم نظام Blade Templating</li>
                            <li>تعلم استخدام Middleware</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>Artisan CLI - أداة سطر الأوامر</h3>
                        <p>Artisan هو أداة سطر الأوامر المدمجة في Laravel التي تساعد في إنشاء الكود وإدارة التطبيق.</p>
                        
                        <pre><code># عرض جميع الأوامر المتاحة
php artisan list

# إنشاء Controller جديد
php artisan make:controller UserController

# إنشاء Model جديد
php artisan make:model User

# إنشاء Migration جديد
php artisan make:migration create_users_table

# إنشاء Seeder جديد
php artisan make:seeder UserSeeder

# تشغيل Migrations
php artisan migrate

# تشغيل Seeders
php artisan db:seed

# مسح Cache
php artisan cache:clear
php artisan config:clear
php artisan route:clear</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> أوامر Artisan المفيدة:</h4>
                            <ul>
                                <li><strong>make:controller:</strong> ينشئ Controller جديد</li>
                                <li><strong>make:model:</strong> ينشئ Model جديد</li>
                                <li><strong>make:migration:</strong> ينشئ Migration جديد</li>
                                <li><strong>make:middleware:</strong> ينشئ Middleware جديد</li>
                                <li><strong>make:request:</strong> ينشئ Form Request جديد</li>
                                <li><strong>migrate:</strong> يشغل Migrations</li>
                                <li><strong>db:seed:</strong> يشغل Seeders</li>
                            </ul>
                        </div>

                        <h3>إنشاء Controller</h3>
                        <pre><code>// app/Http/Controllers/UserController.php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class UserController extends Controller
{
    /**
     * عرض قائمة المستخدمين
     */
    public function index()
    {
        $users = User::all();
        return view('users.index', compact('users'));
    }

    /**
     * عرض نموذج إنشاء مستخدم جديد
     */
    public function create()
    {
        return view('users.create');
    }

    /**
     * حفظ مستخدم جديد
     */
    public function store(Request $request)
    {
        $validated = $request->validate([
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users',
            'password' => 'required|min:8',
        ]);

        User::create($validated);
        
        return redirect()->route('users.index')
                        ->with('success', 'تم إنشاء المستخدم بنجاح');
    }

    /**
     * عرض مستخدم محدد
     */
    public function show(User $user)
    {
        return view('users.show', compact('user'));
    }

    /**
     * عرض نموذج تعديل مستخدم
     */
    public function edit(User $user)
    {
        return view('users.edit', compact('user'));
    }

    /**
     * تحديث مستخدم محدد
     */
    public function update(Request $request, User $user)
    {
        $validated = $request->validate([
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users,email,' . $user->id,
        ]);

        $user->update($validated);
        
        return redirect()->route('users.index')
                        ->with('success', 'تم تحديث المستخدم بنجاح');
    }

    /**
     * حذف مستخدم محدد
     */
    public function destroy(User $user)
    {
        $user->delete();
        
        return redirect()->route('users.index')
                        ->with('success', 'تم حذف المستخدم بنجاح');
    }
}</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-lightbulb"></i> Resource Controller:</h4>
                            <p>Laravel يوفر Resource Controllers التي تحتوي على جميع العمليات CRUD الأساسية. يمكن إنشاؤها باستخدام:</p>
                            <pre><code>php artisan make:controller UserController --resource</code></pre>
                            
                            <h4><i class="fas fa-exclamation-triangle"></i> نصائح للـ Controllers:</h4>
                            <ul>
                                <li>استخدم Resource Controllers للعمليات CRUD</li>
                                <li>احتفظ بالـ Controllers بسيطة ومركزة</li>
                                <li>استخدم Form Requests للتحقق من البيانات</li>
                                <li>استخدم Model Binding لتقليل الكود</li>
                            </ul>
                        </div>

                        <h3>إنشاء Views مع Blade</h3>
                        <pre><code>{{-- resources/views/users/index.blade.php --}}
@extends('layouts.app')

@section('title', 'قائمة المستخدمين')

@section('content')
<div class="container">
    <div class="row">
        <div class="col-12">
            <h1>قائمة المستخدمين</h1>
            
            @if(session('success'))
                <div class="alert alert-success">
                    {{ session('success') }}
                </div>
            @endif

            <div class="mb-3">
                <a href="{{ route('users.create') }}" class="btn btn-primary">
                    إضافة مستخدم جديد
                </a>
            </div>

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>الاسم</th>
                        <th>البريد الإلكتروني</th>
                        <th>تاريخ الإنشاء</th>
                        <th>الإجراءات</th>
                    </tr>
                </thead>
                <tbody>
                    @forelse($users as $user)
                        <tr>
                            <td>{{ $user->name }}</td>
                            <td>{{ $user->email }}</td>
                            <td>{{ $user->created_at->format('Y-m-d') }}</td>
                            <td>
                                <a href="{{ route('users.show', $user) }}" class="btn btn-sm btn-info">
                                    عرض
                                </a>
                                <a href="{{ route('users.edit', $user) }}" class="btn btn-sm btn-warning">
                                    تعديل
                                </a>
                                <form action="{{ route('users.destroy', $user) }}" method="POST" 
                                      style="display: inline-block;" 
                                      onsubmit="return confirm('هل أنت متأكد من الحذف؟')">
                                    @csrf
                                    @method('DELETE')
                                    <button type="submit" class="btn btn-sm btn-danger">
                                        حذف
                                    </button>
                                </form>
                            </td>
                        </tr>
                    @empty
                        <tr>
                            <td colspan="4" class="text-center">لا توجد مستخدمين</td>
                        </tr>
                    @endforelse
                </tbody>
            </table>
        </div>
    </div>
</div>
@endsection</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> Blade Directives:</h4>
                            <ul>
                                <li><strong>@extends:</strong> يرث من layout أساسي</li>
                                <li><strong>@section:</strong> يحدد محتوى قسم معين</li>
                                <li><strong>@if/@else/@endif:</strong> شروط شرطية</li>
                                <li><strong>@foreach/@forelse:</strong> حلقات التكرار</li>
                                <li><strong>{{ }}:</strong> عرض متغير مع escape</li>
                                <li><strong>{!! !!}:</strong> عرض HTML بدون escape</li>
                                <li><strong>@csrf:</strong> token للحماية من CSRF</li>
                            </ul>
                        </div>

                        <h3>إنشاء Layout أساسي</h3>
                        <pre><code>{{-- resources/views/layouts/app.blade.php --}}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@yield('title', 'Laravel App')</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ route('home') }}">
                <i class="fas fa-laravel"></i> Laravel App
            </a>
            
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="{{ route('users.index') }}">
                    <i class="fas fa-users"></i> المستخدمين
                </a>
                <a class="nav-link" href="{{ route('posts.index') }}">
                    <i class="fas fa-newspaper"></i> المقالات
                </a>
            </div>
        </div>
    </nav>

    <main class="py-4">
        @yield('content')
    </main>

    <footer class="bg-dark text-light py-3 mt-5">
        <div class="container text-center">
            <p>&copy; 2024 Laravel App. جميع الحقوق محفوظة.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html></code></pre>
                    </div>
                </div>
            </section>

            <!-- Routing -->
            <section id="routing" class="lesson-section">
                <h2><i class="fas fa-route"></i> التوجيه والتحكم</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم نظام Routing في Laravel</li>
                            <li>تعلم إنشاء Routes مختلفة</li>
                            <li>فهم Route Parameters و Constraints</li>
                            <li>تعلم استخدام Route Groups و Middleware</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>نظام Routing الأساسي</h3>
                        <pre><code>// routes/web.php

use App\Http\Controllers\UserController;
use App\Http\Controllers\PostController;
use Illuminate\Support\Facades\Route;

// Route أساسي
Route::get('/', function () {
    return view('welcome');
});

// Route مع Controller
Route::get('/users', [UserController::class, 'index']);

// Resource Routes (CRUD كامل)
Route::resource('users', UserController::class);

// Routes مخصصة
Route::get('/users/{user}/profile', [UserController::class, 'profile']);
Route::post('/users/{user}/avatar', [UserController::class, 'updateAvatar']);

// Routes مع Parameters
Route::get('/posts/{id}', [PostController::class, 'show']);
Route::get('/posts/{post}/comments/{comment}', [PostController::class, 'showComment']);

// Routes مع Constraints
Route::get('/users/{id}', [UserController::class, 'show'])
    ->where('id', '[0-9]+');

Route::get('/posts/{slug}', [PostController::class, 'show'])
    ->where('slug', '[A-Za-z0-9-]+');</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> أنواع Routes:</h4>
                            <ul>
                                <li><strong>GET:</strong> لاسترجاع البيانات</li>
                                <li><strong>POST:</strong> لإرسال البيانات</li>
                                <li><strong>PUT/PATCH:</strong> لتحديث البيانات</li>
                                <li><strong>DELETE:</strong> لحذف البيانات</li>
                                <li><strong>resource:</strong> ينشئ جميع Routes للـ CRUD</li>
                            </ul>
                        </div>

                        <h3>Route Groups و Middleware</h3>
                        <pre><code>// routes/web.php

// Route Group مع Middleware
Route::middleware(['auth'])->group(function () {
    Route::get('/dashboard', [DashboardController::class, 'index']);
    Route::get('/profile', [ProfileController::class, 'show']);
    Route::post('/profile', [ProfileController::class, 'update']);
});

// Route Group مع Prefix
Route::prefix('admin')->group(function () {
    Route::get('/users', [Admin\UserController::class, 'index']);
    Route::get('/posts', [Admin\PostController::class, 'index']);
    Route::get('/settings', [Admin\SettingsController::class, 'index']);
});

// Route Group مع Namespace
Route::namespace('Admin')->prefix('admin')->middleware(['auth', 'admin'])->group(function () {
    Route::resource('users', UserController::class);
    Route::resource('posts', PostController::class);
    Route::resource('categories', CategoryController::class);
});

// Route Group مع Name Prefix
Route::name('admin.')->prefix('admin')->middleware(['auth', 'admin'])->group(function () {
    Route::get('/dashboard', [AdminController::class, 'dashboard'])->name('dashboard');
    Route::get('/reports', [AdminController::class, 'reports'])->name('reports');
});</code></pre>

                        <h3>API Routes</h3>
                        <pre><code>// routes/api.php

use App\Http\Controllers\Api\UserController;
use App\Http\Controllers\Api\PostController;
use Illuminate\Support\Facades\Route;

// API Routes مع Authentication
Route::middleware('auth:sanctum')->group(function () {
    Route::apiResource('users', UserController::class);
    Route::apiResource('posts', PostController::class);
    
    // Routes مخصصة للـ API
    Route::get('/user/profile', [UserController::class, 'profile']);
    Route::post('/user/avatar', [UserController::class, 'updateAvatar']);
    Route::get('/posts/{post}/comments', [PostController::class, 'comments']);
});

// Public API Routes
Route::get('/public/posts', [PostController::class, 'publicPosts']);
Route::get('/public/categories', [CategoryController::class, 'index']);</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-lightbulb"></i> نصائح للـ Routing:</h4>
                            <ul>
                                <li>استخدم Route Groups لتنظيم Routes المتشابهة</li>
                                <li>طبق Middleware على مجموعات Routes</li>
                                <li>استخدم Prefix لتنظيم URLs</li>
                                <li>استخدم Namespace لتنظيم Controllers</li>
                                <li>استخدم apiResource للـ API Routes</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Database -->
            <section id="database" class="lesson-section">
                <h2><i class="fas fa-database"></i> قاعدة البيانات</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم نظام Migrations في Laravel</li>
                            <li>تعلم إنشاء Models مع Eloquent ORM</li>
                            <li>فهم العلاقات بين Models</li>
                            <li>تعلم استخدام Seeders و Factories</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>Migrations - هجرات قاعدة البيانات</h3>
                        <pre><code>// database/migrations/2024_01_01_000001_create_users_table.php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->string('avatar')->nullable();
            $table->boolean('is_active')->default(true);
            $table->rememberToken();
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('users');
    }
};</code></pre>

                        <h3>إنشاء Migration جديد</h3>
                        <pre><code># إنشاء Migration لجدول Posts
php artisan make:migration create_posts_table

# إنشاء Migration لتعديل جدول موجود
php artisan make:migration add_category_id_to_posts_table --table=posts

# تشغيل Migrations
php artisan migrate

# إلغاء آخر Migration
php artisan migrate:rollback

# إلغاء جميع Migrations
php artisan migrate:reset

# إعادة تشغيل جميع Migrations
php artisan migrate:refresh</code></pre>

                        <h3>Eloquent Models</h3>
                        <pre><code>// app/Models/User.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;

class User extends Authenticatable
{
    use HasFactory, Notifiable;

    protected $fillable = [
        'name',
        'email',
        'password',
        'avatar',
        'is_active',
    ];

    protected $hidden = [
        'password',
        'remember_token',
    ];

    protected $casts = [
        'email_verified_at' => 'datetime',
        'is_active' => 'boolean',
    ];

    // العلاقات
    public function posts()
    {
        return $this->hasMany(Post::class);
    }

    public function comments()
    {
        return $this->hasMany(Comment::class);
    }

    public function profile()
    {
        return $this->hasOne(Profile::class);
    }

    // Scopes
    public function scopeActive($query)
    {
        return $query->where('is_active', true);
    }

    // Accessors & Mutators
    public function getFullNameAttribute()
    {
        return $this->name;
    }

    public function setPasswordAttribute($value)
    {
        $this->attributes['password'] = bcrypt($value);
    }
}</code></pre>

                        <h3>العلاقات بين Models</h3>
                        <pre><code>// app/Models/Post.php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Post extends Model
{
    use HasFactory;

    protected $fillable = [
        'title',
        'content',
        'slug',
        'published_at',
        'user_id',
        'category_id',
    ];

    protected $casts = [
        'published_at' => 'datetime',
    ];

    // العلاقة مع User (Many-to-One)
    public function user()
    {
        return $this->belongsTo(User::class);
    }

    // العلاقة مع Category (Many-to-One)
    public function category()
    {
        return $this->belongsTo(Category::class);
    }

    // العلاقة مع Comments (One-to-Many)
    public function comments()
    {
        return $this->hasMany(Comment::class);
    }

    // العلاقة مع Tags (Many-to-Many)
    public function tags()
    {
        return $this->belongsToMany(Tag::class);
    }

    // Scopes
    public function scopePublished($query)
    {
        return $query->whereNotNull('published_at')
                    ->where('published_at', '<=', now());
    }

    public function scopeByCategory($query, $categoryId)
    {
        return $query->where('category_id', $categoryId);
    }
}</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> أنواع العلاقات:</h4>
                            <ul>
                                <li><strong>hasOne:</strong> علاقة واحد لواحد</li>
                                <li><strong>hasMany:</strong> علاقة واحد لكثير</li>
                                <li><strong>belongsTo:</strong> علاقة كثير لواحد</li>
                                <li><strong>belongsToMany:</strong> علاقة كثير لكثير</li>
                                <li><strong>hasManyThrough:</strong> علاقة عبر جدول وسيط</li>
                            </ul>
                        </div>

                        <h3>Seeders و Factories</h3>
                        <pre><code>// database/factories/UserFactory.php
<?php

namespace Database\Factories;

use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Str;

class UserFactory extends Factory
{
    public function definition()
    {
        return [
            'name' => $this->faker->name(),
            'email' => $this->faker->unique()->safeEmail(),
            'email_verified_at' => now(),
            'password' => '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi',
            'avatar' => $this->faker->imageUrl(200, 200),
            'is_active' => $this->faker->boolean(80),
            'remember_token' => Str::random(10),
        ];
    }

    public function inactive()
    {
        return $this->state(function (array $attributes) {
            return [
                'is_active' => false,
            ];
        });
    }
}</code></pre>

                        <pre><code>// database/seeders/DatabaseSeeder.php
<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;

class DatabaseSeeder extends Seeder
{
    public function run()
    {
        // إنشاء 50 مستخدم
        \App\Models\User::factory(50)->create();

        // إنشاء 10 مستخدمين غير نشطين
        \App\Models\User::factory(10)->inactive()->create();

        // إنشاء مستخدم إداري
        \App\Models\User::factory()->create([
            'name' => 'Admin User',
            'email' => 'admin@example.com',
            'is_active' => true,
        ]);

        // إنشاء فئات
        \App\Models\Category::factory(10)->create();

        // إنشاء مقالات
        \App\Models\Post::factory(100)->create();
    }
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Authentication -->
            <section id="authentication" class="lesson-section">
                <h2><i class="fas fa-shield-alt"></i> المصادقة والأمان</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم نظام Authentication في Laravel</li>
                            <li>تعلم إنشاء نظام تسجيل دخول وخروج</li>
                            <li>فهم Middleware و Authorization</li>
                            <li>تعلم حماية Routes والموارد</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>إعداد Authentication</h3>
                        <pre><code># تثبيت Laravel Breeze (نظام مصادقة بسيط)
composer require laravel/breeze --dev

# تثبيت Breeze مع Blade
php artisan breeze:install blade

# تشغيل Migrations
php artisan migrate

# تثبيت NPM dependencies
npm install && npm run dev</code></pre>

                        <h3>إنشاء Middleware مخصص</h3>
                        <pre><code>// app/Http/Middleware/AdminMiddleware.php
<?php

namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;

class AdminMiddleware
{
    public function handle(Request $request, Closure $next)
    {
        if (!auth()->check()) {
            return redirect()->route('login');
        }

        if (!auth()->user()->is_admin) {
            abort(403, 'غير مصرح لك بالوصول إلى هذه الصفحة');
        }

        return $next($request);
    }
}</code></pre>

                        <h3>تسجيل Middleware</h3>
                        <pre><code>// app/Http/Kernel.php
protected $routeMiddleware = [
    // ... existing middleware
    'admin' => \App\Http\Middleware\AdminMiddleware::class,
    'verified' => \Illuminate\Auth\Middleware\EnsureEmailIsVerified::class,
];</code></pre>

                        <h3>Form Requests للتحقق</h3>
                        <pre><code>// app/Http/Requests/StoreUserRequest.php
<?php

namespace App\Http\Requests;

use Illuminate\Foundation\Http\FormRequest;

class StoreUserRequest extends FormRequest
{
    public function authorize()
    {
        return true; // أو منطق التحقق من الصلاحيات
    }

    public function rules()
    {
        return [
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users,email',
            'password' => 'required|string|min:8|confirmed',
            'avatar' => 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048',
        ];
    }

    public function messages()
    {
        return [
            'name.required' => 'الاسم مطلوب',
            'email.required' => 'البريد الإلكتروني مطلوب',
            'email.unique' => 'هذا البريد الإلكتروني مستخدم بالفعل',
            'password.min' => 'كلمة المرور يجب أن تكون 8 أحرف على الأقل',
            'password.confirmed' => 'تأكيد كلمة المرور غير متطابق',
        ];
    }
}</code></pre>

                        <h3>استخدام Form Request في Controller</h3>
                        <pre><code>// app/Http/Controllers/UserController.php
public function store(StoreUserRequest $request)
{
    $validated = $request->validated();
    
    // تشفير كلمة المرور
    $validated['password'] = bcrypt($validated['password']);
    
    // رفع الصورة
    if ($request->hasFile('avatar')) {
        $validated['avatar'] = $request->file('avatar')->store('avatars', 'public');
    }
    
    User::create($validated);
    
    return redirect()->route('users.index')
                    ->with('success', 'تم إنشاء المستخدم بنجاح');
}</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-lightbulb"></i> نصائح الأمان:</h4>
                            <ul>
                                <li>استخدم Form Requests للتحقق من البيانات</li>
                                <li>طبق Middleware على Routes الحساسة</li>
                                <li>استخدم CSRF tokens في جميع النماذج</li>
                                <li>شفر كلمات المرور دائماً</li>
                                <li>تحقق من صلاحيات المستخدمين</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- API Development -->
            <section id="api" class="lesson-section">
                <h2><i class="fas fa-plug"></i> تطوير APIs</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم تطوير RESTful APIs</li>
                            <li>تعلم استخدام Laravel Sanctum للمصادقة</li>
                            <li>فهم API Resources و Transformers</li>
                            <li>تعلم معالجة الأخطاء في APIs</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>تثبيت Laravel Sanctum</h3>
                        <pre><code># تثبيت Sanctum
composer require laravel/sanctum

# نشر ملفات Sanctum
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"

# تشغيل Migration
php artisan migrate</code></pre>

                        <h3>إعداد API Controller</h3>
                        <pre><code>// app/Http/Controllers/Api/UserController.php
<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Http\Resources\UserResource;
use App\Models\User;
use Illuminate\Http\Request;

class UserController extends Controller
{
    public function index()
    {
        $users = User::with(['posts', 'profile'])->paginate(15);
        return UserResource::collection($users);
    }

    public function store(Request $request)
    {
        $validated = $request->validate([
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users',
            'password' => 'required|min:8',
        ]);

        $user = User::create($validated);
        return new UserResource($user);
    }

    public function show(User $user)
    {
        return new UserResource($user->load(['posts', 'profile']));
    }

    public function update(Request $request, User $user)
    {
        $validated = $request->validate([
            'name' => 'sometimes|string|max:255',
            'email' => 'sometimes|email|unique:users,email,' . $user->id,
        ]);

        $user->update($validated);
        return new UserResource($user);
    }

    public function destroy(User $user)
    {
        $user->delete();
        return response()->json(['message' => 'تم حذف المستخدم بنجاح']);
    }
}</code></pre>

                        <h3>API Resources</h3>
                        <pre><code>// app/Http/Resources/UserResource.php
<?php

namespace App\Http\Resources;

use Illuminate\Http\Resources\Json\JsonResource;

class UserResource extends JsonResource
{
    public function toArray($request)
    {
        return [
            'id' => $this->id,
            'name' => $this->name,
            'email' => $this->email,
            'avatar' => $this->avatar ? asset('storage/' . $this->avatar) : null,
            'is_active' => $this->is_active,
            'created_at' => $this->created_at->format('Y-m-d H:i:s'),
            'updated_at' => $this->updated_at->format('Y-m-d H:i:s'),
            
            // العلاقات
            'posts_count' => $this->whenLoaded('posts', function () {
                return $this->posts->count();
            }),
            
            'profile' => new ProfileResource($this->whenLoaded('profile')),
            'posts' => PostResource::collection($this->whenLoaded('posts')),
        ];
    }
}</code></pre>

                        <h3>API Authentication</h3>
                        <pre><code>// app/Http/Controllers/Api/AuthController.php
<?php

namespace App\Http\Controllers\Api;

use App\Http\Controllers\Controller;
use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;
use Illuminate\Validation\ValidationException;

class AuthController extends Controller
{
    public function login(Request $request)
    {
        $request->validate([
            'email' => 'required|email',
            'password' => 'required',
        ]);

        $user = User::where('email', $request->email)->first();

        if (!$user || !Hash::check($request->password, $user->password)) {
            throw ValidationException::withMessages([
                'email' => ['البيانات المدخلة غير صحيحة'],
            ]);
        }

        $token = $user->createToken('api-token')->plainTextToken;

        return response()->json([
            'user' => $user,
            'token' => $token,
        ]);
    }

    public function logout(Request $request)
    {
        $request->user()->currentAccessToken()->delete();

        return response()->json(['message' => 'تم تسجيل الخروج بنجاح']);
    }

    public function me(Request $request)
    {
        return response()->json($request->user());
    }
}</code></pre>

                        <h3>API Routes</h3>
                        <pre><code>// routes/api.php
use App\Http\Controllers\Api\AuthController;
use App\Http\Controllers\Api\UserController;
use Illuminate\Support\Facades\Route;

// Public routes
Route::post('/login', [AuthController::class, 'login']);

// Protected routes
Route::middleware('auth:sanctum')->group(function () {
    Route::post('/logout', [AuthController::class, 'logout']);
    Route::get('/me', [AuthController::class, 'me']);
    
    Route::apiResource('users', UserController::class);
});</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-info-circle"></i> نصائح تطوير APIs:</h4>
                            <ul>
                                <li>استخدم API Resources لتحويل البيانات</li>
                                <li>طبق Pagination على القوائم الطويلة</li>
                                <li>استخدم Status Codes المناسبة</li>
                                <li>وثق APIs باستخدام Swagger أو Postman</li>
                                <li>طبق Rate Limiting لحماية APIs</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Advanced Concepts -->
            <section id="advanced" class="lesson-section">
                <h2><i class="fas fa-cogs"></i> مفاهيم متقدمة</h2>
                
                <div class="lesson">
                    <div class="learning-objectives explanation">
                        <h3><i class="fas fa-target"></i> أهداف التعلم</h3>
                        <ul>
                            <li>فهم Service Container و Dependency Injection</li>
                            <li>تعلم إنشاء Services و Repositories</li>
                            <li>فهم Events و Listeners</li>
                            <li>تعلم استخدام Queues و Jobs</li>
                        </ul>
                    </div>

                    <div class="lesson-content">
                        <h3>Service Container و Dependency Injection</h3>
                        <pre><code>// app/Services/UserService.php
<?php

namespace App\Services;

use App\Models\User;
use App\Repositories\UserRepository;
use Illuminate\Support\Facades\Hash;

class UserService
{
    protected $userRepository;

    public function __construct(UserRepository $userRepository)
    {
        $this->userRepository = $userRepository;
    }

    public function createUser(array $data): User
    {
        $data['password'] = Hash::make($data['password']);
        return $this->userRepository->create($data);
    }

    public function updateUser(User $user, array $data): User
    {
        if (isset($data['password'])) {
            $data['password'] = Hash::make($data['password']);
        }
        
        return $this->userRepository->update($user, $data);
    }

    public function deleteUser(User $user): bool
    {
        return $this->userRepository->delete($user);
    }
}</code></pre>

                        <h3>Repository Pattern</h3>
                        <pre><code>// app/Repositories/UserRepository.php
<?php

namespace App\Repositories;

use App\Models\User;
use Illuminate\Database\Eloquent\Collection;

class UserRepository
{
    public function all(): Collection
    {
        return User::all();
    }

    public function find(int $id): ?User
    {
        return User::find($id);
    }

    public function create(array $data): User
    {
        return User::create($data);
    }

    public function update(User $user, array $data): User
    {
        $user->update($data);
        return $user->fresh();
    }

    public function delete(User $user): bool
    {
        return $user->delete();
    }

    public function findByEmail(string $email): ?User
    {
        return User::where('email', $email)->first();
    }

    public function getActiveUsers(): Collection
    {
        return User::where('is_active', true)->get();
    }
}</code></pre>

                        <h3>Events و Listeners</h3>
                        <pre><code>// app/Events/UserCreated.php
<?php

namespace App\Events;

use App\Models\User;
use Illuminate\Broadcasting\InteractsWithSockets;
use Illuminate\Foundation\Events\Dispatchable;
use Illuminate\Queue\SerializesModels;

class UserCreated
{
    use Dispatchable, InteractsWithSockets, SerializesModels;

    public $user;

    public function __construct(User $user)
    {
        $this->user = $user;
    }
}</code></pre>

                        <pre><code>// app/Listeners/SendWelcomeEmail.php
<?php

namespace App\Listeners;

use App\Events\UserCreated;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Support\Facades\Mail;

class SendWelcomeEmail implements ShouldQueue
{
    use InteractsWithQueue;

    public function handle(UserCreated $event)
    {
        Mail::to($event->user->email)->send(new WelcomeEmail($event->user));
    }
}</code></pre>

                        <h3>Queues و Jobs</h3>
                        <pre><code>// app/Jobs/ProcessUserData.php
<?php

namespace App\Jobs;

use App\Models\User;
use Illuminate\Bus\Queueable;
use Illuminate\Contracts\Queue\ShouldQueue;
use Illuminate\Foundation\Bus\Dispatchable;
use Illuminate\Queue\InteractsWithQueue;
use Illuminate\Queue\SerializesModels;

class ProcessUserData implements ShouldQueue
{
    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels;

    protected $user;

    public function __construct(User $user)
    {
        $this->user = $user;
    }

    public function handle()
    {
        // معالجة البيانات
        $this->user->update([
            'processed_at' => now(),
        ]);

        // إرسال إشعار
        $this->user->notify(new DataProcessedNotification());
    }
}</code></pre>

                        <h3>استخدام Jobs في Controller</h3>
                        <pre><code>// app/Http/Controllers/UserController.php
public function store(StoreUserRequest $request)
{
    $user = User::create($request->validated());
    
    // تشغيل Job في الخلفية
    ProcessUserData::dispatch($user);
    
    // إرسال Event
    event(new UserCreated($user));
    
    return redirect()->route('users.index')
                    ->with('success', 'تم إنشاء المستخدم بنجاح');
}</code></pre>

                        <div class="code-explanation">
                            <h4><i class="fas fa-lightbulb"></i> نصائح للمفاهيم المتقدمة:</h4>
                            <ul>
                                <li>استخدم Service Layer لفصل منطق العمل</li>
                                <li>طبق Repository Pattern لتنظيم استعلامات قاعدة البيانات</li>
                                <li>استخدم Events للفصل بين المكونات</li>
                                <li>استخدم Queues للمهام الثقيلة</li>
                                <li>وثق الكود واكتب Tests</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Code Playground -->
            <section id="playground" class="lesson-section">
                <h2><i class="fas fa-play"></i> ملعب الكود</h2>
                
                <div class="lesson">
                    <div class="lesson-content">
                        <p>جرب كود Laravel في هذا الملعب التفاعلي:</p>
                        
                        <div class="playground-container">
                            <div class="code-editor">
                                <h3>أدخل كود Laravel</h3>
                                <div class="laravel-examples">
                                    <button class="example-btn" onclick="loadLaravelExample('controller')">Controller</button>
                                    <button class="example-btn" onclick="loadLaravelExample('model')">Model</button>
                                    <button class="example-btn" onclick="loadLaravelExample('route')">Route</button>
                                    <button class="example-btn" onclick="loadLaravelExample('blade')">Blade</button>
                                    <button class="example-btn" onclick="loadLaravelExample('migration')">Migration</button>
                                </div>
                                <textarea id="laravelPlaygroundCode" placeholder="// اكتب كود Laravel هنا
Route::get('/users', [UserController::class, 'index']);">// مثال على Route في Laravel
Route::get('/users', function () {
    $users = User::all();
    return view('users.index', compact('users'));
});</textarea>
                                <div>
                                    <button class="run-code-btn" onclick="runLaravelPlayground()">تشغيل الكود</button>
                                    <button class="clear-btn" onclick="clearLaravelPlayground()">مسح</button>
                                    <button class="format-btn" onclick="formatLaravelCode()">تنسيق الكود</button>
                                </div>
                            </div>
                            
                            <div class="playground-output">
                                <h3>النتائج</h3>
                                <div id="laravelPlaygroundOutput">
                                    <div class="php-simulation">
                                        <p><strong>ملاحظة:</strong> هذا محاكي لـ Laravel. في البيئة الحقيقية، سيتم تنفيذ الكود على خادم Laravel.</p>
                                        <div class="code-output">
                                            النتائج ستظهر هنا بعد تشغيل الكود...
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            </div>
        </main>

        <aside class="sidebar-navigation">
            <div class="sidebar-header">
                <h3><i class="fas fa-list"></i> محتويات الدورة</h3>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav class="sidebar-nav">
                <ul class="sidebar-nav-list">
                    <li><a href="index.html" class="sidebar-nav-link">
                        <i class="fas fa-home"></i>
                        <span>الرئيسية</span>
                    </a></li>
                    <li><a href="#introduction" class="sidebar-nav-link active" data-level="introduction">
                        <i class="fas fa-rocket"></i>
                        <span>مقدمة</span>
                    </a></li>
                    <li><a href="#installation" class="sidebar-nav-link" data-level="installation">
                        <i class="fas fa-download"></i>
                        <span>التثبيت والإعداد</span>
                    </a></li>
                    <li><a href="#basics" class="sidebar-nav-link" data-level="basics">
                        <i class="fas fa-code"></i>
                        <span>أساسيات Laravel</span>
                    </a></li>
                    <li><a href="#routing" class="sidebar-nav-link" data-level="routing">
                        <i class="fas fa-route"></i>
                        <span>التوجيه والتحكم</span>
                    </a></li>
                    <li><a href="#database" class="sidebar-nav-link" data-level="database">
                        <i class="fas fa-database"></i>
                        <span>قاعدة البيانات</span>
                    </a></li>
                    <li><a href="#authentication" class="sidebar-nav-link" data-level="authentication">
                        <i class="fas fa-shield-alt"></i>
                        <span>المصادقة والأمان</span>
                    </a></li>
                    <li><a href="#api" class="sidebar-nav-link" data-level="api">
                        <i class="fas fa-plug"></i>
                        <span>تطوير APIs</span>
                    </a></li>
                    <li><a href="#advanced" class="sidebar-nav-link" data-level="advanced">
                        <i class="fas fa-cogs"></i>
                        <span>مفاهيم متقدمة</span>
                    </a></li>
                    <li><a href="#playground" class="sidebar-nav-link" data-level="playground">
                        <i class="fas fa-play"></i>
                        <span>ملعب الكود</span>
                    </a></li>
                </ul>
            </nav>
        </aside>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Training Partners</h3>
                    <div class="footer-logos">
                        <a href="https://www.mof.gov.sy/ar">
                            <img src="assets/Syrian_logo_icon_gold.png" alt="Ministry of Finance" class="footer-logo">
                            <span>Ministry of Finance</span>
                        </a>
                        <a href="https://www.sceit.gov.sy/ar">
                            <img src="assets/logo-sceit.png" alt="SCEIT" class="footer-logo">
                            <span>Syrian Center of Excellence in IT</span>
                        </a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="laravel-tutorial.html">Laravel Tutorial</a></li>
                        <li><a href="postgresql-tutorial.html">PostgreSQL Tutorial</a></li>
                        <li><a href="api-tutorial.html">API Development</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Laravel Resources</h3>
                    <ul class="footer-links">
                        <li><a href="https://laravel.com/docs" target="_blank">Laravel Documentation</a></li>
                        <li><a href="https://laravel.com/download" target="_blank">Download Laravel</a></li>
                        <li><a href="https://laracasts.com" target="_blank">Laracasts</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Web Development Training Program. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Sidebar functionality
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebarMobileToggle = document.getElementById('sidebarMobileToggle');
            const sidebar = document.querySelector('.sidebar-navigation');
            const sidebarLinks = document.querySelectorAll('.sidebar-nav-link');
            const sidebarBackdrop = document.getElementById('sidebarBackdrop');

            // Toggle sidebar on desktop
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('collapsed');
                });
            }

            // Toggle sidebar on mobile
            if (sidebarMobileToggle) {
                sidebarMobileToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('mobile-open');
                    sidebarBackdrop.classList.toggle('active');
                });
            }

            // Close sidebar when clicking backdrop
            if (sidebarBackdrop) {
                sidebarBackdrop.addEventListener('click', function() {
                    sidebar.classList.remove('mobile-open');
                    sidebarBackdrop.classList.remove('active');
                });
            }

            // Handle sidebar navigation
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    // Check if it's an external link (not a hash link)
                    if (!this.getAttribute('href').startsWith('#')) {
                        // Allow external links to work normally
                        return;
                    }
                    
                    // Close mobile sidebar after navigation
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('mobile-open');
                        sidebarBackdrop.classList.remove('active');
                    }
                });
            });

            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 768 && 
                    !sidebar.contains(e.target) && 
                    !sidebarMobileToggle.contains(e.target)) {
                    sidebar.classList.remove('mobile-open');
                    sidebarBackdrop.classList.remove('active');
                }
            });

            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    sidebar.classList.remove('mobile-open');
                    sidebarBackdrop.classList.remove('active');
                }
            });
        });

        // Laravel Examples Data
        const laravelExamples = {
            controller: `// UserController.php
<?php

namespace App\\Http\\Controllers;

use App\\Models\\User;
use Illuminate\\Http\\Request;

class UserController extends Controller
{
    public function index()
    {
        $users = User::all();
        return view('users.index', compact('users'));
    }

    public function store(Request $request)
    {
        $validated = $request->validate([
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users',
            'password' => 'required|min:8',
        ]);

        User::create($validated);
        
        return redirect()->route('users.index')
                        ->with('success', 'تم إنشاء المستخدم بنجاح');
    }
}`,

            model: `// User.php
<?php

namespace App\\Models;

use Illuminate\\Database\\Eloquent\\Factories\\HasFactory;
use Illuminate\\Foundation\\Auth\\User as Authenticatable;

class User extends Authenticatable
{
    use HasFactory;

    protected $fillable = [
        'name',
        'email',
        'password',
    ];

    protected $hidden = [
        'password',
        'remember_token',
    ];

    // العلاقات
    public function posts()
    {
        return $this->hasMany(Post::class);
    }

    // Scopes
    public function scopeActive($query)
    {
        return $query->where('is_active', true);
    }
}`,

            route: `// routes/web.php
use App\\Http\\Controllers\\UserController;
use Illuminate\\Support\\Facades\\Route;

// Route أساسي
Route::get('/', function () {
    return view('welcome');
});

// Resource Routes
Route::resource('users', UserController::class);

// Routes مع Middleware
Route::middleware(['auth'])->group(function () {
    Route::get('/dashboard', [DashboardController::class, 'index']);
});`,

            blade: `{{-- users/index.blade.php --}}
@extends('layouts.app')

@section('title', 'قائمة المستخدمين')

@section('content')
<div class="container">
    <h1>قائمة المستخدمين</h1>
    
    @if(session('success'))
        <div class="alert alert-success">
            {{ session('success') }}
        </div>
    @endif

    <table class="table">
        <thead>
            <tr>
                <th>الاسم</th>
                <th>البريد الإلكتروني</th>
                <th>الإجراءات</th>
            </tr>
        </thead>
        <tbody>
            @foreach($users as $user)
                <tr>
                    <td>{{ $user->name }}</td>
                    <td>{{ $user->email }}</td>
                    <td>
                        <a href="{{ route('users.show', $user) }}" class="btn btn-sm btn-info">
                            عرض
                        </a>
                    </td>
                </tr>
            @endforeach
        </tbody>
    </table>
</div>
@endsection`,

            migration: `// create_users_table.php
<?php

use Illuminate\\Database\\Migrations\\Migration;
use Illuminate\\Database\\Schema\\Blueprint;
use Illuminate\\Support\\Facades\\Schema;

return new class extends Migration
{
    public function up()
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->boolean('is_active')->default(true);
            $table->rememberToken();
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('users');
    }
};`
        };

        // Laravel Tutorial JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation functionality
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.lesson-section');

            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all links and sections
                    navLinks.forEach(l => l.classList.remove('active'));
                    sections.forEach(s => s.classList.remove('active'));
                    
                    // Add active class to clicked link
                    this.classList.add('active');
                    
                    // Show corresponding section
                    const targetId = this.getAttribute('data-level');
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                });
            });
        });

        // Laravel Playground Functions
        function runLaravelPlayground() {
            const code = document.getElementById('laravelPlaygroundCode').value;
            const output = document.getElementById('laravelPlaygroundOutput');

            if (!output) return;

            try {
                output.innerHTML = '<div class="php-simulation">';
                output.innerHTML += '<p><strong>ملاحظة:</strong> هذا محاكي لـ Laravel. في البيئة الحقيقية، سيتم تنفيذ الكود على خادم Laravel.</p>';
                output.innerHTML += '<div class="code-output">';
                
                let simulatedOutput = simulateLaravelOutput(code);
                output.innerHTML += simulatedOutput;
                output.innerHTML += '</div></div>';
                
                showLaravelFeedback('تم تشغيل الكود بنجاح!', 'success');
            } catch (error) {
                showLaravelFeedback('خطأ في الكود: ' + error.message, 'error');
            }
        }

        function simulateLaravelOutput(code) {
            let output = '';
            const lowerCode = code.toLowerCase();
            
            if (lowerCode.includes('route::get')) {
                output += '<div class="success-message">';
                output += '<p>✅ تم إنشاء Route بنجاح</p>';
                output += '<p><strong>URL:</strong> /users</p>';
                output += '<p><strong>Method:</strong> GET</p>';
                output += '<p><strong>Response:</strong> View rendered successfully</p>';
                output += '</div>';
            } else if (lowerCode.includes('user::create') || lowerCode.includes('user::all')) {
                output += '<div class="success-message">';
                output += '<p>✅ تم تنفيذ عملية قاعدة البيانات بنجاح</p>';
                output += '<p><strong>Model:</strong> User</p>';
                output += '<p><strong>Operation:</strong> ' + (lowerCode.includes('create') ? 'Create' : 'Read') + '</p>';
                output += '<p><strong>Records affected:</strong> 1</p>';
                output += '</div>';
            } else if (lowerCode.includes('view(') || lowerCode.includes('@extends')) {
                output += '<div class="success-message">';
                output += '<p>✅ تم تحميل View بنجاح</p>';
                output += '<p><strong>Template:</strong> Blade</p>';
                output += '<p><strong>Status:</strong> Rendered successfully</p>';
                output += '</div>';
            } else if (lowerCode.includes('migration') || lowerCode.includes('schema::create')) {
                output += '<div class="success-message">';
                output += '<p>✅ تم تنفيذ Migration بنجاح</p>';
                output += '<p><strong>Table:</strong> users</p>';
                output += '<p><strong>Status:</strong> Created successfully</p>';
                output += '</div>';
            } else {
                output += '<div class="success-message">';
                output += '<p>✅ تم تنفيذ الكود بنجاح</p>';
                output += '<p><strong>Status:</strong> No errors found</p>';
                output += '</div>';
            }
            
            return output;
        }

        function loadLaravelExample(type) {
            const textarea = document.getElementById('laravelPlaygroundCode');
            if (laravelExamples[type]) {
                textarea.value = laravelExamples[type];
                showLaravelFeedback(`تم تحميل مثال: ${type}`, 'info');
            }
        }

        function formatLaravelCode() {
            const textarea = document.getElementById('laravelPlaygroundCode');
            let code = textarea.value;
            
            // Simple PHP formatting
            code = code
                .replace(/\{/g, '{\n    ')
                .replace(/\}/g, '\n}')
                .replace(/;/g, ';\n')
                .replace(/\n\s*\n/g, '\n')
                .trim();
            
            textarea.value = code;
            showLaravelFeedback('تم تنسيق الكود', 'info');
        }

        function clearLaravelPlayground() {
            document.getElementById('laravelPlaygroundCode').value = `// مثال على Route في Laravel
Route::get('/users', function () {
    $users = User::all();
    return view('users.index', compact('users'));
});`;
            document.getElementById('laravelPlaygroundOutput').innerHTML = '<div class="php-simulation"><p><strong>ملاحظة:</strong> هذا محاكي لـ Laravel. في البيئة الحقيقية، سيتم تنفيذ الكود على خادم Laravel.</p><div class="code-output">النتائج ستظهر هنا بعد تشغيل الكود...</div></div>';
        }

        function showLaravelFeedback(message, type) {
            // Create or update feedback element
            let feedback = document.getElementById('laravelFeedback');
            if (!feedback) {
                feedback = document.createElement('div');
                feedback.id = 'laravelFeedback';
                feedback.style.cssText = 'position: fixed; top: 20px; right: 20px; padding: 10px 15px; border-radius: 5px; z-index: 1000; font-weight: bold;';
                document.body.appendChild(feedback);
            }
            
            feedback.textContent = message;
            feedback.className = `feedback-${type}`;
            
            // Set colors based on type
            switch(type) {
                case 'success':
                    feedback.style.backgroundColor = '#d4edda';
                    feedback.style.color = '#155724';
                    feedback.style.border = '1px solid #c3e6cb';
                    break;
                case 'error':
                    feedback.style.backgroundColor = '#f8d7da';
                    feedback.style.color = '#721c24';
                    feedback.style.border = '1px solid #f5c6cb';
                    break;
                case 'info':
                    feedback.style.backgroundColor = '#d1ecf1';
                    feedback.style.color = '#0c5460';
                    feedback.style.border = '1px solid #bee5eb';
                    break;
            }
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                if (feedback) {
                    feedback.remove();
                }
            }, 3000);
        }
    </script>
</body>
</html>
